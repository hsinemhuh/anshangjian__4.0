<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èƒŒè¯µæ¯”å¯¹ - å²¸ä¸Šè§</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="../css/dark-mode.css">
    <script src="../js/theme-init.js"></script>
    <style>
        .content-box {
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
            margin: 16px auto;
            overflow: hidden;
            padding: 0;
            max-width: 92%;
            width: 100%;
        }

        .dark-mode .content-box {
            background: #1c1c1e;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.2);
        }

        .box-header {
            padding: 12px 16px;
            border-bottom: 1px solid #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .input-area {
            min-height: 140px;
            max-height: 180px;
            overflow-y: auto;
            padding: 16px;
            font-size: 16px;
            line-height: 1.6;
            color: #333;
            background: #fafafa;
        }

        .upload-options {
            display: flex;
            gap: 12px;
            padding: 12px 16px;
            border-top: 1px solid #f0f0f0;
            justify-content: center;
        }

        .upload-btn {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 8px 12px;
            border-radius: 20px;
            background: #f5f5f5;
            color: #666;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .upload-btn:hover {
            background: #ebebeb;
        }

        .voice-record-btn {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: #ff2442;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            position: relative;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 2px 8px rgba(255, 36, 66, 0.3);
            transform: translateY(0);
            cursor: pointer;
        }

        .voice-record-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(255, 36, 66, 0.4);
        }

        .voice-record-btn:active {
            transform: scale(0.92) translateY(2px);
            box-shadow: 0 1px 3px rgba(255, 36, 66, 0.2);
        }

        .voice-record-btn::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: #ff2442;
            opacity: 0.3;
            transform: scale(0);
            transition: transform 0.3s ease;
        }

        .voice-record-btn.recording::before {
            animation: pulse 1.5s infinite;
        }

        .voice-record-btn.recording {
            background: #e61e3c;
            box-shadow: 0 0 12px rgba(230, 30, 60, 0.5);
            animation: recording-pulse 1s infinite alternate;
        }

        @keyframes recording-pulse {
            0% {
                transform: scale(1);
            }
            100% {
                transform: scale(1.08);
            }
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
                opacity: 0.3;
            }
            100% {
                transform: scale(1.5);
                opacity: 0;
            }
        }

        .result-panel {
            position: fixed;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            padding: 20px;
            transition: transform 0.5s cubic-bezier(0.19, 1, 0.22, 1);
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            overflow-y: auto;
            display: none;
            transform: translateY(100%);
        }

        .result-panel.show {
            transform: translateY(0);
        }

        .result-panel-header {
            position: sticky;
            top: 0;
            background: white;
            padding: 16px 0;
            margin: -20px -20px 20px -20px;
            padding: 20px;
            border-bottom: 1px solid #f0f0f0;
            display: flex;
            align-items: center;
            z-index: 10;
        }

        .result-panel-title {
            font-size: 18px;
            font-weight: 600;
            flex-grow: 1;
        }

        .result-panel-close {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: #f5f5f5;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            transition: all 0.3s ease;
        }

        .result-panel-close:hover {
            background: #ebebeb;
            transform: rotate(90deg);
        }

        .score-circle {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            border: 4px solid #ff2442;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            font-weight: bold;
            color: #ff2442;
            margin: 0 auto 20px;
            position: relative;
            animation: scoreAppear 1s forwards;
            opacity: 0;
            transform: scale(0.8);
        }

        @keyframes scoreAppear {
            0% {
            opacity: 0;
                transform: scale(0.8);
        }
            100% {
            opacity: 1;
                transform: scale(1);
            }
        }

        .score-circle::after {
            content: '';
            position: absolute;
            width: calc(100% + 16px);
            height: calc(100% + 16px);
            border-radius: 50%;
            border: 1px solid rgba(255, 36, 66, 0.2);
            animation: pulseRing 2s infinite;
        }

        @keyframes pulseRing {
            0% {
                transform: scale(0.95);
                opacity: 0.7;
            }
            50% {
                transform: scale(1);
                opacity: 0.3;
            }
            100% {
                transform: scale(0.95);
                opacity: 0.7;
            }
        }

        .progress-bar {
            height: 6px;
            background: #f0f0f0;
            border-radius: 3px;
            overflow: hidden;
            margin: 8px 0;
        }

        .progress-bar-fill {
            height: 100%;
            background: #ff2442;
            border-radius: 3px;
            transition: width 1.5s cubic-bezier(0.19, 1, 0.22, 1);
            width: 0 !important;
        }

        .progress-bar-fill.animate {
            width: var(--progress-width) !important;
        }

        .analysis-section {
            background: #fff;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.05);
            animation: fadeInUp 0.8s forwards;
            opacity: 0;
            transform: translateY(20px);
        }

        .analysis-section:nth-child(2) {
            animation-delay: 0.2s;
        }

        .analysis-section:nth-child(3) {
            animation-delay: 0.4s;
        }

        .analysis-section:nth-child(4) {
            animation-delay: 0.6s;
        }

        @keyframes fadeInUp {
            0% {
            opacity: 0;
                transform: translateY(20px);
        }
            100% {
            opacity: 1;
            transform: translateY(0);
        }
        }

        .continue-btn {
            width: 100%;
            background: #ff2442;
            color: white;
            padding: 14px 0;
            border-radius: 12px;
            font-weight: 600;
            font-size: 16px;
            margin: 16px 0;
            box-shadow: 0 4px 12px rgba(255, 36, 66, 0.2);
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            animation: fadeInUp 0.8s forwards;
            animation-delay: 0.8s;
            opacity: 0;
        }

        .continue-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(255, 36, 66, 0.25);
        }

        .continue-btn:active {
            transform: scale(0.98) translateY(0);
            box-shadow: 0 2px 8px rgba(255, 36, 66, 0.2);
        }

        .example-btn {
            position: absolute;
            top: 16px;
            right: 16px;
            background: #f5f5f5;
            padding: 6px 12px;
            border-radius: 16px;
            font-size: 12px;
            color: #666;
            display: flex;
            align-items: center;
            gap: 4px;
            transition: all 0.2s ease;
        }

        .example-btn:hover, .example-btn:active {
            background: #ebebeb;
            transform: scale(1.05);
        }

        .recording-timer {
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.6);
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 14px;
            display: none;
        }

        .recording-timer.show {
            display: block;
        }

        .highlight {
            background: #fff3f5;
            border-radius: 4px;
            padding: 2px 4px;
        }

        .diff-text {
            color: #ff2442;
            text-decoration: line-through;
        }

        .tutorial-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            display: none;
            opacity: 0;
            transition: opacity 0.3s ease;
            -webkit-backdrop-filter: blur(4px);
            backdrop-filter: blur(4px);
        }

        .tutorial-overlay.show {
            display: flex;
            opacity: 1;
        }

        .tutorial-content {
            background: white;
            width: 90%;
            max-width: 360px;
            margin: auto;
            border-radius: 16px;
            padding: 24px;
            transform: translateY(20px);
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }

        .tutorial-overlay.show .tutorial-content {
            transform: translateY(0);
        }

        .tutorial-step {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin-bottom: 16px;
        }

        .step-number {
            width: 24px;
            height: 24px;
            background: #ff2442;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            flex-shrink: 0;
        }

        /* ä¿®å¤å¡ç‰‡è¾¹è·é—®é¢˜ */
        @media (max-width: 430px) {
            .content-box {
                margin: 12px auto;
            }
            
            .input-area {
                min-height: 120px;
            }
        }

        /* æ·»åŠ ç¤ºä¾‹é€‰æ‹©å™¨æ ·å¼ */
        .example-selector {
            position: absolute;
            top: 50px;
            right: 16px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            padding: 12px;
            z-index: 100;
            width: 200px;
            display: none;
            opacity: 0;
            transform: translateY(-10px);
            transition: opacity 0.3s ease, transform 0.3s ease;
        }

        .example-selector.show {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }

        .example-item {
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .example-item:last-child {
            margin-bottom: 0;
        }

        .example-item:hover {
            background: #f5f5f5;
        }

        .example-item-title {
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 4px;
        }

        .example-item-desc {
            font-size: 12px;
            color: #666;
        }

        /* æ·»åŠ å¡ç‰‡å®¹å™¨æ ·å¼ï¼Œä½¿ä¸¤ä¸ªå¡ç‰‡å±…ä¸­æ˜¾ç¤º */
        .cards-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            padding: 0 16px;
        }

        /* æ¯”å¯¹æŒ‰é’®æ ·å¼å¢å¼º */
        .compare-btn {
            width: 100%;
            background: #ff2442;
            color: white;
            padding: 14px 0;
            border-radius: 12px;
            font-weight: 600;
            font-size: 16px;
            margin: 16px 0 24px;
            box-shadow: 0 4px 12px rgba(255, 36, 66, 0.2);
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            overflow: hidden;
        }

        .compare-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(255, 36, 66, 0.25);
        }

        .compare-btn:active {
            transform: scale(0.98) translateY(0);
            box-shadow: 0 2px 8px rgba(255, 36, 66, 0.2);
        }

        .compare-btn.loading {
            pointer-events: none;
            background: #ff3b59;
        }

        .compare-btn.loading::after {
            content: "";
            position: absolute;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            left: calc(50% - 30px);
            top: calc(50% - 10px);
            animation: rotate 1s linear infinite;
        }

        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* ä½¿ç”¨è¯´æ˜æŒ‰é’®æ ·å¼å¢å¼º */
        .tutorial-btn {
            display: flex;
            align-items: center;
            gap: 4px;
            padding: 6px 10px;
            border-radius: 16px;
            background: rgba(255, 36, 66, 0.1);
            color: #ff2442;
            transition: all 0.3s ease;
        }

        .tutorial-btn:hover {
            background: rgba(255, 36, 66, 0.15);
            transform: translateY(-1px);
        }

        .tutorial-btn:active {
            transform: translateY(1px);
        }

        .tutorial-btn i {
            transition: transform 0.3s ease;
        }

        .tutorial-btn:hover i {
            transform: rotate(15deg);
        }

        @media (min-width: 768px) {
            .cards-container {
                padding: 0 24px;
            }
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="app-container">
        <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
        <div class="sticky top-0 bg-white z-10 px-4 py-3 border-b border-gray-200">
            <div class="flex items-center">
                <a href="home.html" class="mr-4" title="è¿”å›é¦–é¡µ">
                    <i class="fas fa-arrow-left text-xl text-gray-600"></i>
                </a>
                <h1 class="text-lg font-semibold">èƒŒè¯µæ¯”å¯¹</h1>
                <button class="ml-auto tutorial-btn" onclick="showTutorial()">
                    <i class="fas fa-question-circle"></i>
                    <span>ä½¿ç”¨è¯´æ˜</span>
                </button>
            </div>
        </div>

        <!-- å†…å®¹åŒºåŸŸ -->
        <div class="content-area" id="content">
            <!-- å¡ç‰‡å®¹å™¨ -->
            <div class="cards-container">
                <!-- æ­£ç¡®ç‰ˆæœ¬æ¡† -->
                <div class="content-box">
                    <div class="box-header">
                        <span class="font-semibold">æ­£ç¡®ç‰ˆæœ¬</span>
                        <span class="text-sm text-gray-500">è¯·è¾“å…¥è¦èƒŒè¯µçš„å†…å®¹</span>
                        <button class="example-btn" onclick="toggleExampleSelector()">
                            <i class="fas fa-lightbulb"></i>
                            <span>åŠ è½½ç¤ºä¾‹</span>
                        </button>
                        <div class="example-selector" id="exampleSelector">
                            <!-- ç¤ºä¾‹é€‰é¡¹å°†é€šè¿‡JavaScriptåŠ¨æ€æ·»åŠ  -->
                        </div>
                    </div>
                    <div class="input-area" id="correctVersion" contenteditable="true" placeholder="åœ¨æ­¤è¾“å…¥æˆ–ç²˜è´´æ–‡æœ¬..."></div>
                    <div class="upload-options">
                        <button class="upload-btn" onclick="uploadPhoto('camera', 'correct')" title="æ‹ç…§ä¸Šä¼ ">
                            <i class="fas fa-camera"></i>
                            <span>æ‹ç…§ä¸Šä¼ </span>
                        </button>
                        <button class="upload-btn" onclick="uploadPhoto('gallery', 'correct')" title="ä»ç›¸å†Œé€‰æ‹©">
                            <i class="fas fa-image"></i>
                            <span>ä»ç›¸å†Œé€‰æ‹©</span>
                        </button>
                    </div>
                </div>

                <!-- èƒŒè¯µç‰ˆæœ¬æ¡† -->
                <div class="content-box">
                    <div class="box-header">
                        <span class="font-semibold">èƒŒè¯µç‰ˆæœ¬</span>
                        <span class="text-sm text-gray-500">è¯·æäº¤æ‚¨çš„èƒŒè¯µå†…å®¹</span>
                    </div>
                    <div class="input-area" id="reciteVersion" contenteditable="true" placeholder="åœ¨æ­¤è¾“å…¥æˆ–ç²˜è´´æ–‡æœ¬..."></div>
                    <div class="upload-options">
                        <button class="upload-btn" onclick="uploadPhoto('camera', 'recite')" title="æ‹ç…§ä¸Šä¼ ">
                            <i class="fas fa-camera"></i>
                            <span>æ‹ç…§ä¸Šä¼ </span>
                        </button>
                        <button class="upload-btn" onclick="uploadPhoto('gallery', 'recite')" title="ä»ç›¸å†Œé€‰æ‹©">
                            <i class="fas fa-image"></i>
                            <span>ä»ç›¸å†Œé€‰æ‹©</span>
                        </button>
                        <button class="voice-record-btn" id="recordBtn" title="è¯­éŸ³å½•åˆ¶">
                            <i class="fas fa-microphone"></i>
                            <span class="recording-timer" id="recordingTimer">00:00</span>
                        </button>
                    </div>
                </div>

                <!-- æ¯”å¯¹æŒ‰é’® -->
                <button class="compare-btn" id="compareBtn" onclick="startCompare()">
                    å¼€å§‹ç”Ÿæˆ
                </button>
            </div>
        </div>

        <!-- åº•éƒ¨å¯¼èˆªæ  -->
        <nav class="bottom-nav">
            <div class="nav-items">
                <a href="home.html" class="nav-item">
                    <i class="fas fa-home"></i>
                    <span>é¦–é¡µ</span>
                </a>
                <a href="discover.html" class="nav-item">
                    <i class="fas fa-compass"></i>
                    <span>å‘ç°</span>
                </a>
                <a href="recite.html" class="nav-item recite-nav-item active">
                    <div class="recite-icon-wrapper">
                        <i class="fas fa-book-reader"></i>
                    </div>
                    <span>èƒŒè¯µæ¯”å¯¹</span>
                </a>
                <a href="message.html" class="nav-item">
                    <i class="fas fa-comment-dots"></i>
                    <span>æ¶ˆæ¯</span>
                </a>
                <a href="profile.html" class="nav-item">
                    <i class="fas fa-user"></i>
                    <span>æˆ‘çš„</span>
                </a>
            </div>
        </nav>
    </div>

    <!-- æ¯”å¯¹ç»“æœé¢æ¿ -->
    <div class="result-panel" id="resultPanel">
        <div class="result-panel-header">
            <div class="result-panel-title">èƒŒè¯µæ¯”å¯¹ç»“æœ</div>
            <button class="result-panel-close" onclick="closeResultPanel()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="text-center mb-6">
            <div class="score-circle" id="scoreCircle">92</div>
            <div class="text-xl font-semibold mt-2" id="scoreComment">éå¸¸æ£’ï¼ç»§ç»­ä¿æŒ</div>
        </div>
        
        <div class="analysis-section">
            <h3 class="font-semibold mb-3">è¯„åˆ†è¯¦æƒ…</h3>
        <div class="mb-4">
            <div class="flex justify-between text-sm text-gray-500 mb-2">
                <span>å†…å®¹å®Œæ•´åº¦</span>
                <span id="completenessScore">95%</span>
            </div>
            <div class="progress-bar">
                    <div class="progress-bar-fill" id="completenessFill" style="--progress-width: 95%"></div>
            </div>
        </div>
        <div class="mb-4">
            <div class="flex justify-between text-sm text-gray-500 mb-2">
                <span>è¡¨è¾¾å‡†ç¡®åº¦</span>
                <span id="accuracyScore">90%</span>
            </div>
            <div class="progress-bar">
                    <div class="progress-bar-fill" id="accuracyFill" style="--progress-width: 90%"></div>
            </div>
        </div>
        <div class="mb-4">
            <div class="flex justify-between text-sm text-gray-500 mb-2">
                <span>é€»è¾‘è¿è´¯æ€§</span>
                <span id="logicScore">92%</span>
            </div>
            <div class="progress-bar">
                    <div class="progress-bar-fill" id="logicFill" style="--progress-width: 92%"></div>
            </div>
        </div>
        </div>
        
        <div class="analysis-section">
            <h3 class="font-semibold mb-3">è¯¦ç»†åˆ†æ</h3>
            <p class="text-gray-600 text-sm" id="analysisIntro">æ‚¨çš„èƒŒè¯µå†…å®¹åŸºæœ¬å®Œæ•´ï¼Œé‡ç‚¹å†…å®¹æŠŠæ¡å‡†ç¡®ã€‚ä»¥ä¸‹æ˜¯å…·ä½“åˆ†æï¼š</p>
            <ul class="text-sm text-gray-600 mt-3 space-y-3" id="analysisDetails">
                <li>âœ“ å®Œæ•´å¤è¿°äº†é©¬å…‹æ€ä¸»ä¹‰å“²å­¦çš„åŸºæœ¬åŸç†</li>
                <li>âœ“ å‡†ç¡®æŠŠæ¡äº†"å®è·µ"ä¸"è®¤è¯†"çš„è¾©è¯å…³ç³»</li>
                <li>âš ï¸ "<span class="diff-text">è®¤è¯†è§„å¾‹æ˜¯ä»æ„Ÿæ€§è®¤è¯†åˆ°ç†æ€§è®¤è¯†</span>" åº”ä¸º "<span class="highlight">è®¤è¯†çš„è§„å¾‹æ˜¯ç”±æ„Ÿæ€§è®¤è¯†åˆ°ç†æ€§è®¤è¯†</span>"</li>
                <li>ğŸ’¡ å»ºè®®åŠ å¼ºå¯¹ä»¥ä¸‹æ¦‚å¿µçš„ç†è§£ï¼š
                    <ul class="ml-4 mt-1 list-disc">
                        <li>å®è·µä¸è®¤è¯†çš„å…³ç³»</li>
                        <li>çœŸç†çš„ç»å¯¹æ€§ä¸ç›¸å¯¹æ€§</li>
                    </ul>
                </li>
            </ul>
        </div>
        
        <div class="analysis-section">
            <h3 class="font-semibold mb-3">è®°å¿†æ›²çº¿åˆ†æ</h3>
            <p class="text-gray-600 text-sm">æ ¹æ®æ‚¨çš„èƒŒè¯µå†å²ï¼Œæˆ‘ä»¬åˆ†æäº†æ‚¨çš„è®°å¿†æ›²çº¿ï¼š</p>
            <div class="h-32 bg-white rounded-lg mt-3 p-2 flex items-end justify-between">
                <div class="h-3/4 w-8 bg-green-100 rounded-t-md relative">
                    <span class="absolute -top-6 left-1/2 transform -translate-x-1/2 text-xs text-gray-500">é¦–æ¬¡</span>
                    <span class="absolute -bottom-6 left-1/2 transform -translate-x-1/2 text-xs text-gray-500">85%</span>
                </div>
                <div class="h-5/6 w-8 bg-green-200 rounded-t-md relative">
                    <span class="absolute -top-6 left-1/2 transform -translate-x-1/2 text-xs text-gray-500">1å¤©å</span>
                    <span class="absolute -bottom-6 left-1/2 transform -translate-x-1/2 text-xs text-gray-500">88%</span>
                </div>
                <div class="h-11/12 w-8 bg-green-300 rounded-t-md relative">
                    <span class="absolute -top-6 left-1/2 transform -translate-x-1/2 text-xs text-gray-500">3å¤©å</span>
                    <span class="absolute -bottom-6 left-1/2 transform -translate-x-1/2 text-xs text-gray-500">92%</span>
                </div>
                <div class="h-full w-8 bg-green-400 rounded-t-md relative">
                    <span class="absolute -top-6 left-1/2 transform -translate-x-1/2 text-xs text-gray-500">7å¤©å</span>
                    <span class="absolute -bottom-6 left-1/2 transform -translate-x-1/2 text-xs text-gray-500">95%</span>
                </div>
                <div class="h-5/6 w-8 bg-gray-200 rounded-t-md relative border-2 border-dashed border-gray-400">
                    <span class="absolute -top-6 left-1/2 transform -translate-x-1/2 text-xs text-gray-500">14å¤©å</span>
                    <span class="absolute -bottom-6 left-1/2 transform -translate-x-1/2 text-xs text-gray-500">é¢„æµ‹</span>
                </div>
            </div>
            <p class="text-xs text-gray-500 mt-8 text-center">å»ºè®®åœ¨7å¤©åè¿›è¡Œä¸‹ä¸€æ¬¡å¤ä¹ ï¼Œä»¥å·©å›ºè®°å¿†</p>
        </div>
        
        <button class="continue-btn" onclick="closeResultPanel()">
            ç»§ç»­èƒŒè¯µ
        </button>
    </div>

    <!-- ä½¿ç”¨è¯´æ˜å¼¹çª— -->
    <div class="tutorial-overlay" id="tutorialOverlay">
        <div class="tutorial-content">
            <h2 class="text-xl font-bold mb-4">å¦‚ä½•ä½¿ç”¨èƒŒè¯µæ¯”å¯¹</h2>
            <div class="tutorial-step">
                <div class="step-number">1</div>
                <div>
                    <h3 class="font-semibold mb-1">è¾“å…¥æ­£ç¡®å†…å®¹</h3>
                    <p class="text-sm text-gray-600">åœ¨ä¸Šæ–¹è¾“å…¥æ¡†ä¸­è¾“å…¥è¦èƒŒè¯µçš„å†…å®¹ï¼Œå¯ä»¥ç›´æ¥è¾“å…¥ã€æ‹ç…§æˆ–ä»ç›¸å†Œé€‰æ‹©ï¼Œä¹Ÿå¯ä»¥ç‚¹å‡»"åŠ è½½ç¤ºä¾‹"é€‰æ‹©é¢„è®¾å†…å®¹</p>
                </div>
            </div>
            <div class="tutorial-step">
                <div class="step-number">2</div>
                <div>
                    <h3 class="font-semibold mb-1">æäº¤èƒŒè¯µå†…å®¹</h3>
                    <p class="text-sm text-gray-600">æŒ‰ä½å½•éŸ³æŒ‰é’®å¼€å§‹å½•åˆ¶æ‚¨çš„èƒŒè¯µå†…å®¹ï¼Œæ¾å¼€æŒ‰é’®ç»“æŸå½•åˆ¶ï¼›æˆ–ç›´æ¥åœ¨ä¸‹æ–¹è¾“å…¥æ¡†ä¸­è¾“å…¥æ–‡å­—</p>
                </div>
            </div>
            <div class="tutorial-step">
                <div class="step-number">3</div>
                <div>
                    <h3 class="font-semibold mb-1">æŸ¥çœ‹åˆ†æç»“æœ</h3>
                    <p class="text-sm text-gray-600">ç‚¹å‡»"å¼€å§‹ç”Ÿæˆ"æŒ‰é’®ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åˆ†ææ‚¨çš„èƒŒè¯µå†…å®¹ï¼Œå¹¶ç»™å‡ºè¯¦ç»†çš„è¯„åˆ†å’Œæ”¹è¿›å»ºè®®</p>
                </div>
            </div>
            <div class="p-4 bg-gray-50 rounded-lg mt-4 mb-4">
                <h3 class="font-semibold mb-2 text-sm">èƒŒè¯µæ¯”å¯¹åŠŸèƒ½è¯´æ˜</h3>
                <p class="text-xs text-gray-600">èƒŒè¯µæ¯”å¯¹åŠŸèƒ½åŸºäºAIå¤§æ¨¡å‹æŠ€æœ¯ï¼Œä¸ä»…æ¯”å¯¹æ–‡å­—çš„ç›¸ä¼¼åº¦ï¼Œæ›´æ³¨é‡å¯¹å†…å®¹ç†è§£çš„å‡†ç¡®æ€§ã€‚ç³»ç»Ÿä¼šä»å†…å®¹å®Œæ•´åº¦ã€è¡¨è¾¾å‡†ç¡®åº¦å’Œé€»è¾‘è¿è´¯æ€§ä¸‰ä¸ªç»´åº¦è¿›è¡Œè¯„åˆ†ï¼Œå¹¶æä¾›é’ˆå¯¹æ€§çš„æ”¹è¿›å»ºè®®ã€‚</p>
            </div>
            <button class="w-full bg-red-500 text-white py-3 rounded-full font-semibold mt-4" onclick="closeTutorial()">
                çŸ¥é“äº†
            </button>
        </div>
    </div>

    <script>
        let isRecording = false;
        let recordingTimer;
        let startTime;
        const recordBtn = document.getElementById('recordBtn');
        const resultPanel = document.getElementById('resultPanel');
        const timerDisplay = document.getElementById('recordingTimer');
        const tutorialOverlay = document.getElementById('tutorialOverlay');
        const correctVersion = document.getElementById('correctVersion');
        const reciteVersion = document.getElementById('reciteVersion');
        const exampleSelector = document.getElementById('exampleSelector');

        // ç¤ºä¾‹å†…å®¹
        const exampleContents = {
            philosophy: {
                correct: `é©¬å…‹æ€ä¸»ä¹‰è®¤è¯†è®ºè®¤ä¸ºï¼šå®è·µæ˜¯è®¤è¯†çš„æ¥æºã€‚è®¤è¯†çš„è¿‡ç¨‹æ˜¯ä¸€ä¸ªå®è·µã€è®¤è¯†ã€å†å®è·µã€å†è®¤è¯†çš„å¾ªç¯ä¸Šå‡è¿‡ç¨‹ã€‚å®è·µæ˜¯æ£€éªŒçœŸç†çš„æ ¹æœ¬æ ‡å‡†ã€‚

çœŸç†å…·æœ‰å®¢è§‚æ€§ï¼ŒåŒæ—¶å…·æœ‰ç»å¯¹æ€§å’Œç›¸å¯¹æ€§çš„ç»Ÿä¸€ã€‚è®¤è¯†çš„è§„å¾‹æ˜¯ç”±æ„Ÿæ€§è®¤è¯†åˆ°ç†æ€§è®¤è¯†ï¼Œå†ç”±ç†æ€§è®¤è¯†åˆ°å®è·µçš„é£è·ƒã€‚`,
                recite: `é©¬å…‹æ€ä¸»ä¹‰è®¤è¯†è®ºè®¤ä¸ºå®è·µæ˜¯è®¤è¯†çš„æ¥æºã€‚è®¤è¯†çš„è¿‡ç¨‹æ˜¯å®è·µã€è®¤è¯†ã€å†å®è·µã€å†è®¤è¯†çš„å¾ªç¯ä¸Šå‡è¿‡ç¨‹ã€‚å®è·µæ˜¯æ£€éªŒçœŸç†çš„æ ¹æœ¬æ ‡å‡†ã€‚

çœŸç†å…·æœ‰å®¢è§‚æ€§ï¼Œå…·æœ‰ç»å¯¹æ€§å’Œç›¸å¯¹æ€§çš„ç»Ÿä¸€ç‰¹å¾ã€‚è®¤è¯†è§„å¾‹æ˜¯ç”±æ„Ÿæ€§è®¤è¯†åˆ°ç†æ€§è®¤è¯†ï¼Œå†ä»ç†æ€§è®¤è¯†åˆ°å®è·µçš„é£è·ƒã€‚`,
                analysis: {
                    score: 92,
                    comment: "éå¸¸æ£’ï¼ç»§ç»­ä¿æŒ",
                    completeness: 95,
                    accuracy: 90,
                    logic: 92,
                    intro: "æ‚¨çš„èƒŒè¯µå†…å®¹åŸºæœ¬å®Œæ•´ï¼Œé‡ç‚¹å†…å®¹æŠŠæ¡å‡†ç¡®ã€‚ä»¥ä¸‹æ˜¯å…·ä½“åˆ†æï¼š",
                    details: [
                        "âœ“ å®Œæ•´å¤è¿°äº†é©¬å…‹æ€ä¸»ä¹‰å“²å­¦çš„åŸºæœ¬åŸç†",
                        "âœ“ å‡†ç¡®æŠŠæ¡äº†\"å®è·µ\"ä¸\"è®¤è¯†\"çš„è¾©è¯å…³ç³»",
                        "âš ï¸ \"<span class=\\\"diff-text\\\">è®¤è¯†è§„å¾‹æ˜¯ä»æ„Ÿæ€§è®¤è¯†åˆ°ç†æ€§è®¤è¯†</span>\" åº”ä¸º \"<span class=\\\"highlight\\\">è®¤è¯†çš„è§„å¾‹æ˜¯ç”±æ„Ÿæ€§è®¤è¯†åˆ°ç†æ€§è®¤è¯†</span>\"",
                        "ğŸ’¡ å»ºè®®åŠ å¼ºå¯¹ä»¥ä¸‹æ¦‚å¿µçš„ç†è§£ï¼š<ul class=\\\"ml-4 mt-1 list-disc\\\"><li>å®è·µä¸è®¤è¯†çš„å…³ç³»</li><li>çœŸç†çš„ç»å¯¹æ€§ä¸ç›¸å¯¹æ€§</li></ul>"
                    ]
                }
            },
            politics: {
                correct: `å•†å“æ˜¯ç”¨æ¥äº¤æ¢çš„åŠ³åŠ¨äº§å“ã€‚å•†å“å…·æœ‰ä½¿ç”¨ä»·å€¼å’Œä»·å€¼ä¸¤ä¸ªå› ç´ ã€‚ä½¿ç”¨ä»·å€¼æ˜¯æŒ‡å•†å“èƒ½å¤Ÿæ»¡è¶³äººä»¬æŸç§éœ€è¦çš„å±æ€§ï¼Œæ˜¯å•†å“çš„è‡ªç„¶å±æ€§ã€‚ä»·å€¼æ˜¯å‡ç»“åœ¨å•†å“ä¸­çš„æ— å·®åˆ«çš„äººç±»åŠ³åŠ¨ï¼Œæ˜¯å•†å“çš„ç¤¾ä¼šå±æ€§ã€‚

å•†å“çš„äºŒå› ç´ åæ˜ äº†ç”Ÿäº§å•†å“çš„åŠ³åŠ¨çš„äºŒé‡æ€§ï¼šå…·ä½“åŠ³åŠ¨å’ŒæŠ½è±¡åŠ³åŠ¨ã€‚å…·ä½“åŠ³åŠ¨åˆ›é€ ä½¿ç”¨ä»·å€¼ï¼ŒæŠ½è±¡åŠ³åŠ¨å½¢æˆä»·å€¼ã€‚`,
                recite: `å•†å“æ˜¯ç”¨æ¥äº¤æ¢çš„åŠ³åŠ¨äº§å“ï¼Œå…·æœ‰ä½¿ç”¨ä»·å€¼å’Œä»·å€¼ä¸¤ä¸ªåŸºæœ¬å±æ€§ã€‚ä½¿ç”¨ä»·å€¼æ˜¯æŒ‡å•†å“èƒ½å¤Ÿæ»¡è¶³äººä»¬æŸç§éœ€è¦çš„å±æ€§ï¼Œæ˜¯å•†å“çš„è‡ªç„¶å±æ€§ï¼›ä»·å€¼æ˜¯å‡ç»“åœ¨å•†å“ä¸­çš„æ— å·®åˆ«çš„äººç±»åŠ³åŠ¨ï¼Œæ˜¯å•†å“çš„ç¤¾ä¼šå±æ€§ã€‚

å•†å“çš„ä¸¤ä¸ªåŸºæœ¬å±æ€§åæ˜ äº†ç”Ÿäº§å•†å“çš„åŠ³åŠ¨çš„äºŒé‡æ€§ï¼šå…·ä½“åŠ³åŠ¨åˆ›é€ ä½¿ç”¨ä»·å€¼ï¼ŒæŠ½è±¡åŠ³åŠ¨å½¢æˆä»·å€¼ã€‚`,
                analysis: {
                    score: 94,
                    comment: "å‡ºè‰²çš„è¡¨ç°ï¼",
                    completeness: 96,
                    accuracy: 94,
                    logic: 93,
                    intro: "æ‚¨å¯¹æ”¿æ²»ç»æµå­¦æ ¸å¿ƒæ¦‚å¿µçš„ç†è§£éå¸¸åˆ°ä½ï¼Œè¡¨è¿°æ¸…æ™°å‡†ç¡®ï¼š",
                    details: [
                        "âœ“ å‡†ç¡®æè¿°äº†å•†å“çš„å®šä¹‰å’ŒåŸºæœ¬å±æ€§",
                        "âœ“ æ­£ç¡®åŒºåˆ†äº†ä½¿ç”¨ä»·å€¼å’Œä»·å€¼çš„æœ¬è´¨åŒºåˆ«",
                        "âœ“ æ¸…æ™°é˜è¿°äº†å…·ä½“åŠ³åŠ¨å’ŒæŠ½è±¡åŠ³åŠ¨çš„å…³ç³»",
                        "âš ï¸ \"<span class=\\\"diff-text\\\">ä¸¤ä¸ªåŸºæœ¬å±æ€§</span>\" è¡¨è¿°ä¸å¤Ÿå‡†ç¡®ï¼Œåº”ä¸º \"<span class=\\\"highlight\\\">äºŒå› ç´ </span>\"",
                        "ğŸ’¡ å»ºè®®è¿›ä¸€æ­¥ç†è§£ï¼š<ul class=\\\"ml-4 mt-1 list-disc\\\"><li>ä»·å€¼å½¢å¼çš„å‘å±•</li><li>å•†å“æ‹œç‰©æ•™çš„æœ¬è´¨</li></ul>"
                    ]
                }
            },
            history: {
                correct: `æ–°æ°‘ä¸»ä¸»ä¹‰é©å‘½æ˜¯æ— äº§é˜¶çº§é¢†å¯¼çš„ï¼Œäººæ°‘å¤§ä¼—çš„ï¼Œåå¯¹å¸å›½ä¸»ä¹‰ã€å°å»ºä¸»ä¹‰å’Œå®˜åƒšèµ„æœ¬ä¸»ä¹‰çš„é©å‘½ã€‚å…¶åŸºæœ¬å†…å®¹æ˜¯ï¼šæ²¡æ”¶å®˜åƒšèµ„æœ¬ï¼Œæ²¡æ”¶åœ°ä¸»é˜¶çº§çš„åœŸåœ°å½’å†œæ°‘æ‰€æœ‰ï¼Œä¿æŠ¤æ°‘æ—å·¥å•†ä¸šã€‚

æ–°æ°‘ä¸»ä¸»ä¹‰é©å‘½çš„åŠ¨åŠ›æ˜¯å·¥äººé˜¶çº§ã€å†œæ°‘é˜¶çº§ã€åŸå¸‚å°èµ„äº§é˜¶çº§å’Œæ°‘æ—èµ„äº§é˜¶çº§ã€‚å…¶é¢†å¯¼åŠ›é‡æ˜¯å·¥äººé˜¶çº§åŠå…¶æ”¿å…šâ€”â€”ä¸­å›½å…±äº§å…šã€‚`,
                recite: `æ–°æ°‘ä¸»ä¸»ä¹‰é©å‘½æ˜¯æ— äº§é˜¶çº§é¢†å¯¼çš„äººæ°‘å¤§ä¼—çš„é©å‘½ï¼Œåå¯¹å¸å›½ä¸»ä¹‰ã€å°å»ºä¸»ä¹‰å’Œå®˜åƒšèµ„æœ¬ä¸»ä¹‰ã€‚åŸºæœ¬å†…å®¹åŒ…æ‹¬æ²¡æ”¶å®˜åƒšèµ„æœ¬ï¼Œæ²¡æ”¶åœ°ä¸»é˜¶çº§åœŸåœ°å½’å†œæ°‘æ‰€æœ‰ï¼Œä¿æŠ¤æ°‘æ—å·¥å•†ä¸šã€‚

é©å‘½åŠ¨åŠ›æ˜¯å·¥äººé˜¶çº§ã€å†œæ°‘é˜¶çº§ã€åŸå¸‚å°èµ„äº§é˜¶çº§å’Œæ°‘æ—èµ„äº§é˜¶çº§ï¼Œé¢†å¯¼åŠ›é‡æ˜¯å·¥äººé˜¶çº§å’Œä¸­å›½å…±äº§å…šã€‚`,
                analysis: {
                    score: 90,
                    comment: "å¾ˆå¥½çš„ç†è§£ï¼",
                    completeness: 92,
                    accuracy: 90,
                    logic: 89,
                    intro: "æ‚¨å¯¹æ–°æ°‘ä¸»ä¸»ä¹‰é©å‘½çš„ç†è§£åŸºæœ¬æ­£ç¡®ï¼ŒæŠŠæ¡äº†æ ¸å¿ƒè¦ç‚¹ï¼š",
                    details: [
                        "âœ“ æ­£ç¡®æè¿°äº†æ–°æ°‘ä¸»ä¸»ä¹‰é©å‘½çš„æ€§è´¨å’Œå¯¹è±¡",
                        "âœ“ å‡†ç¡®åˆ—ä¸¾äº†é©å‘½çš„åŸºæœ¬å†…å®¹",
                        "âœ“ åŸºæœ¬æŠŠæ¡äº†é©å‘½åŠ¨åŠ›å’Œé¢†å¯¼åŠ›é‡",
                        "âš ï¸ è¡¨è¿°ç•¥æ˜¾ç®€ç•¥ï¼Œå¯ä»¥æ›´åŠ å®Œæ•´åœ°é˜è¿°å„è¦ç‚¹ä¹‹é—´çš„å…³ç³»",
                        "ğŸ’¡ å»ºè®®è¿›ä¸€æ­¥å­¦ä¹ ï¼š<ul class=\\\"ml-4 mt-1 list-disc\\\"><li>æ–°æ°‘ä¸»ä¸»ä¹‰é©å‘½çš„å†å²èƒŒæ™¯</li><li>æ–°æ°‘ä¸»ä¸»ä¹‰ä¸ç¤¾ä¼šä¸»ä¹‰é©å‘½çš„å…³ç³»</li></ul>"
                    ]
                }
            },
            english: {
                correct: `Academic writing is characterized by several features: formality, precision, objectivity, explicitness, hedging, and responsibility. It uses formal language, avoids colloquialisms, and employs precise vocabulary. 

Academic texts aim to be objective, presenting evidence rather than personal opinions. They are explicit about connections between ideas, often use hedging language to qualify claims, and take responsibility for the accuracy of information presented.`,
                recite: `Academic writing has several key features including formality, precision, objectivity, explicitness, hedging and responsibility. It uses formal language and precise vocabulary while avoiding casual expressions.

Academic texts try to be objective by presenting evidence instead of personal views. They make connections between ideas clear, use cautious language when making claims, and take responsibility for information accuracy.`,
                analysis: {
                    score: 95,
                    comment: "ä¼˜ç§€çš„èƒŒè¯µï¼",
                    completeness: 97,
                    accuracy: 95,
                    logic: 94,
                    intro: "æ‚¨å¯¹å­¦æœ¯å†™ä½œç‰¹ç‚¹çš„èƒŒè¯µéå¸¸å‡†ç¡®ï¼ŒæŠŠæ¡äº†æ‰€æœ‰å…³é”®ç‚¹ï¼š",
                    details: [
                        "âœ“ å®Œæ•´åˆ—ä¸¾äº†å­¦æœ¯å†™ä½œçš„å…­å¤§ç‰¹ç‚¹",
                        "âœ“ å‡†ç¡®æè¿°äº†å„ä¸ªç‰¹ç‚¹çš„å…·ä½“è¡¨ç°",
                        "âœ“ è¯­è¨€è¡¨è¾¾æµç•…ï¼Œé€»è¾‘æ¸…æ™°",
                        "âš ï¸ ä¸ªåˆ«è¡¨è¿°ç•¥æœ‰ç®€åŒ–ï¼Œä½†ä¸å½±å“æ•´ä½“ç†è§£",
                        "ğŸ’¡ å»ºè®®è¿›ä¸€æ­¥å­¦ä¹ ï¼š<ul class=\\\"ml-4 mt-1 list-disc\\\"><li>å­¦æœ¯å†™ä½œä¸­çš„å¼•ç”¨è§„èŒƒ</li><li>ä¸åŒå­¦ç§‘çš„å­¦æœ¯å†™ä½œé£æ ¼å·®å¼‚</li></ul>"
                    ]
                }
            },
            math: {
                correct: `æé™çš„Îµ-Î´å®šä¹‰ï¼šè®¾å‡½æ•°f(x)åœ¨ç‚¹xâ‚€çš„æŸä¸€å»å¿ƒé‚»åŸŸå†…æœ‰å®šä¹‰ï¼ŒLæ˜¯ä¸€ä¸ªå¸¸æ•°ã€‚å¦‚æœå¯¹äºä»»æ„ç»™å®šçš„æ­£æ•°Îµï¼Œéƒ½å­˜åœ¨æ­£æ•°Î´ï¼Œä½¿å¾—å½“0<|x-xâ‚€|<Î´æ—¶ï¼Œæœ‰|f(x)-L|<Îµæˆç«‹ï¼Œåˆ™ç§°Lä¸ºå‡½æ•°f(x)å½“xâ†’xâ‚€æ—¶çš„æé™ï¼Œè®°ä½œlim(xâ†’xâ‚€)f(x)=Lã€‚

å‡½æ•°è¿ç»­æ€§å®šä¹‰ï¼šå¦‚æœå‡½æ•°f(x)åœ¨ç‚¹xâ‚€å¤„çš„æé™å­˜åœ¨ä¸”ç­‰äºå‡½æ•°å€¼f(xâ‚€)ï¼Œå³lim(xâ†’xâ‚€)f(x)=f(xâ‚€)ï¼Œåˆ™ç§°å‡½æ•°f(x)åœ¨ç‚¹xâ‚€å¤„è¿ç»­ã€‚`,
                recite: `æé™çš„Îµ-Î´å®šä¹‰æ˜¯ï¼šè®¾å‡½æ•°f(x)åœ¨xâ‚€çš„æŸå»å¿ƒé‚»åŸŸæœ‰å®šä¹‰ï¼ŒLä¸ºå¸¸æ•°ã€‚å¯¹ä»»æ„æ­£æ•°Îµï¼Œå­˜åœ¨æ­£æ•°Î´ï¼Œä½¿å¾—å½“0<|x-xâ‚€|<Î´æ—¶ï¼Œ|f(x)-L|<Îµæˆç«‹ï¼Œåˆ™Lä¸ºå‡½æ•°f(x)å½“xâ†’xâ‚€æ—¶çš„æé™ï¼Œè®°ä¸ºlim(xâ†’xâ‚€)f(x)=Lã€‚

å‡½æ•°è¿ç»­æ€§å®šä¹‰ï¼šå‡½æ•°f(x)åœ¨ç‚¹xâ‚€å¤„çš„æé™å­˜åœ¨ä¸”ç­‰äºå‡½æ•°å€¼f(xâ‚€)ï¼Œå³lim(xâ†’xâ‚€)f(x)=f(xâ‚€)ï¼Œåˆ™å‡½æ•°f(x)åœ¨ç‚¹xâ‚€å¤„è¿ç»­ã€‚`,
                analysis: {
                    score: 98,
                    comment: "å‡ ä¹å®Œç¾ï¼",
                    completeness: 99,
                    accuracy: 98,
                    logic: 97,
                    intro: "æ‚¨å¯¹æé™å’Œè¿ç»­æ€§å®šä¹‰çš„èƒŒè¯µéå¸¸ç²¾ç¡®ï¼š",
                    details: [
                        "âœ“ æé™çš„Îµ-Î´å®šä¹‰è¡¨è¿°å‡†ç¡®å®Œæ•´",
                        "âœ“ å‡½æ•°è¿ç»­æ€§å®šä¹‰è¡¨è¿°ç®€æ´æ˜äº†",
                        "âœ“ æ•°å­¦ç¬¦å·ä½¿ç”¨æ­£ç¡®",
                        "âš ï¸ æé™å®šä¹‰ä¸­ç•¥å»äº†\"è®¾\"å’Œ\"å¦‚æœ\"ç­‰å°‘é‡è¿æ¥è¯ï¼Œä½†ä¸å½±å“æ•°å­¦å«ä¹‰",
                        "ğŸ’¡ å»ºè®®è¿›ä¸€æ­¥å­¦ä¹ ï¼š<ul class=\\\"ml-4 mt-1 list-disc\\\"><li>å‡½æ•°åœ¨åŒºé—´ä¸Šçš„è¿ç»­æ€§</li><li>è¿ç»­å‡½æ•°çš„æ€§è´¨</li></ul>"
                    ]
                }
            }
        };

        // å½•éŸ³æŒ‰é’®ç‚¹å‡»äº‹ä»¶
        recordBtn.addEventListener('touchstart', startRecording);
        recordBtn.addEventListener('touchend', stopRecording);
        recordBtn.addEventListener('mousedown', startRecording);
        recordBtn.addEventListener('mouseup', stopRecording);

        // å¼€å§‹å½•éŸ³
        function startRecording(e) {
            e.preventDefault();
            isRecording = true;
            recordBtn.classList.add('recording');
            timerDisplay.classList.add('show');
            startTime = Date.now();
            
            // æ·»åŠ éœ‡åŠ¨åé¦ˆï¼ˆå¦‚æœè®¾å¤‡æ”¯æŒï¼‰
            if (navigator.vibrate) {
                navigator.vibrate(100);
            }
            
            // æ›´æ–°è®¡æ—¶å™¨æ˜¾ç¤º
            recordingTimer = setInterval(updateTimer, 1000);
            
            // è¿™é‡Œåº”è¯¥è°ƒç”¨å®é™…çš„å½•éŸ³API
            console.log('å¼€å§‹å½•éŸ³...');
        }

        // åœæ­¢å½•éŸ³
        function stopRecording(e) {
            if (!isRecording) return;
            
            e.preventDefault();
            isRecording = false;
            recordBtn.classList.remove('recording');
            clearInterval(recordingTimer);
            
            // æ·»åŠ éœ‡åŠ¨åé¦ˆï¼ˆå¦‚æœè®¾å¤‡æ”¯æŒï¼‰
            if (navigator.vibrate) {
                navigator.vibrate([50, 50, 50]);
            }
            
            // è¿™é‡Œåº”è¯¥åœæ­¢å½•éŸ³å¹¶å¤„ç†å½•éŸ³ç»“æœ
            console.log('åœæ­¢å½•éŸ³ï¼Œå½•éŸ³æ—¶é•¿ï¼š' + timerDisplay.textContent);
            
            // æ¨¡æ‹Ÿè¯­éŸ³è¯†åˆ«è¿‡ç¨‹
            setTimeout(() => {
                timerDisplay.classList.remove('show');
                // æ¨¡æ‹Ÿå°†è¯†åˆ«ç»“æœå¡«å…¥èƒŒè¯µç‰ˆæœ¬æ¡†
                reciteVersion.textContent = 'æ­£åœ¨è¯†åˆ«è¯­éŸ³...';
                
                setTimeout(() => {
                    // æ ¹æ®å½“å‰åŠ è½½çš„ç¤ºä¾‹ç±»å‹å¡«å…¥å¯¹åº”çš„èƒŒè¯µå†…å®¹
                    const currentExample = document.querySelector('.example-item-title')?.textContent;
                    if (currentExample === 'é©¬å…‹æ€ä¸»ä¹‰å“²å­¦') {
                        reciteVersion.textContent = exampleContents.philosophy.recite;
                    } else if (currentExample === 'æ”¿æ²»ç»æµå­¦') {
                        reciteVersion.textContent = exampleContents.politics.recite;
                    } else if (currentExample === 'ä¸­å›½è¿‘ä»£å²') {
                        reciteVersion.textContent = exampleContents.history.recite;
                    } else if (currentExample === 'è€ƒç ”è‹±è¯­') {
                        reciteVersion.textContent = exampleContents.english.recite;
                    } else if (currentExample === 'é«˜ç­‰æ•°å­¦') {
                        reciteVersion.textContent = exampleContents.math.recite;
                    } else {
                        reciteVersion.textContent = 'è¯­éŸ³è¯†åˆ«å®Œæˆã€‚è¯·æ£€æŸ¥è¯†åˆ«ç»“æœæ˜¯å¦å‡†ç¡®ã€‚';
                    }
                    
                    // æ·»åŠ è¯†åˆ«å®Œæˆçš„è§†è§‰åé¦ˆ
                    reciteVersion.classList.add('highlight');
                    setTimeout(() => {
                        reciteVersion.classList.remove('highlight');
                    }, 1000);
                }, 1500);
            }, 1000);
        }

        // æ›´æ–°å½•éŸ³è®¡æ—¶å™¨
        function updateTimer() {
            const elapsedTime = Math.floor((Date.now() - startTime) / 1000);
            const minutes = Math.floor(elapsedTime / 60).toString().padStart(2, '0');
            const seconds = (elapsedTime % 60).toString().padStart(2, '0');
            timerDisplay.textContent = `${minutes}:${seconds}`;
        }

        // å¼€å§‹æ¯”å¯¹
        function startCompare() {
            const compareBtn = document.getElementById('compareBtn');
            const correct = correctVersion.textContent.trim();
            const recite = reciteVersion.textContent.trim();
            
            if (!correct || !recite) {
                alert('è¯·ç¡®ä¿æ­£ç¡®ç‰ˆæœ¬å’ŒèƒŒè¯µç‰ˆæœ¬éƒ½å·²å¡«å†™');
                return;
            }
            
            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            compareBtn.innerHTML = '<span style="margin-right: 30px;">ç”Ÿæˆä¸­...</span>';
            compareBtn.classList.add('loading');
            compareBtn.disabled = true;
            
            // æ·»åŠ éœ‡åŠ¨åé¦ˆï¼ˆå¦‚æœè®¾å¤‡æ”¯æŒï¼‰
            if (navigator.vibrate) {
                navigator.vibrate(100);
            }
            
            // æ¨¡æ‹Ÿæ¯”å¯¹è¿‡ç¨‹
            setTimeout(() => {
                // æ ¹æ®å½“å‰å†…å®¹ç¡®å®šè¦æ˜¾ç¤ºçš„åˆ†æç»“æœ
                let analysisResult;
                if (correct.includes('é©¬å…‹æ€ä¸»ä¹‰è®¤è¯†è®º')) {
                    analysisResult = exampleContents.philosophy.analysis;
                } else if (correct.includes('å•†å“æ˜¯ç”¨æ¥äº¤æ¢çš„åŠ³åŠ¨äº§å“')) {
                    analysisResult = exampleContents.politics.analysis;
                } else if (correct.includes('æ–°æ°‘ä¸»ä¸»ä¹‰é©å‘½')) {
                    analysisResult = exampleContents.history.analysis;
                } else if (correct.includes('Academic writing')) {
                    analysisResult = exampleContents.english.analysis;
                } else if (correct.includes('æé™çš„Îµ-Î´å®šä¹‰')) {
                    analysisResult = exampleContents.math.analysis;
                } else {
                    // é»˜è®¤åˆ†æç»“æœ
                    analysisResult = {
                        score: 85,
                        comment: "ä¸é”™çš„å°è¯•ï¼",
                        completeness: 85,
                        accuracy: 82,
                        logic: 88,
                        intro: "æ‚¨çš„èƒŒè¯µå†…å®¹åŸºæœ¬ç¬¦åˆè¦æ±‚ï¼Œä½†è¿˜æœ‰æå‡ç©ºé—´ï¼š",
                        details: [
                            "âœ“ ä¸»è¦å†…å®¹è¦ç‚¹åŸºæœ¬è¦†ç›–",
                            "âš ï¸ éƒ¨åˆ†è¡¨è¿°ä¸å¤Ÿå‡†ç¡®ï¼Œè¯·å¯¹ç…§åŸæ–‡æ£€æŸ¥",
                            "ğŸ’¡ å»ºè®®è¿›ä¸€æ­¥åŠ å¼ºè®°å¿†ï¼Œæé«˜è¡¨è¾¾çš„å‡†ç¡®æ€§å’Œå®Œæ•´æ€§"
                        ]
                    };
                }
                
                // æ›´æ–°ç»“æœé¢æ¿å†…å®¹
                document.getElementById('scoreCircle').textContent = analysisResult.score;
                document.getElementById('scoreComment').textContent = analysisResult.comment;
                document.getElementById('completenessScore').textContent = analysisResult.completeness + '%';
                document.getElementById('completenessFill').style.setProperty('--progress-width', analysisResult.completeness + '%');
                document.getElementById('accuracyScore').textContent = analysisResult.accuracy + '%';
                document.getElementById('accuracyFill').style.setProperty('--progress-width', analysisResult.accuracy + '%');
                document.getElementById('logicScore').textContent = analysisResult.logic + '%';
                document.getElementById('logicFill').style.setProperty('--progress-width', analysisResult.logic + '%');
                document.getElementById('analysisIntro').textContent = analysisResult.intro;
                
                // æ›´æ–°åˆ†æè¯¦æƒ…
                const detailsList = document.getElementById('analysisDetails');
                detailsList.innerHTML = '';
                analysisResult.details.forEach(detail => {
                    const li = document.createElement('li');
                    li.innerHTML = detail;
                    detailsList.appendChild(li);
                });
                
                // æ˜¾ç¤ºç»“æœé¢æ¿ï¼Œæ·»åŠ å…¨å±åŠ¨ç”»æ•ˆæœ
                resultPanel.style.display = 'block';
                
                // æ·»åŠ éœ‡åŠ¨åé¦ˆï¼ˆå¦‚æœè®¾å¤‡æ”¯æŒï¼‰
                if (navigator.vibrate) {
                    navigator.vibrate([50, 100, 50]);
                }
                
                // ä½¿ç”¨åŠ¨ç”»æ•ˆæœæ˜¾ç¤ºç»“æœé¢æ¿
                setTimeout(() => {
                    resultPanel.classList.add('show');
                    
                    // æ¢å¤æŒ‰é’®çŠ¶æ€
                    compareBtn.textContent = 'å¼€å§‹ç”Ÿæˆ';
                    compareBtn.classList.remove('loading');
                    compareBtn.disabled = false;
                    
                    // å»¶è¿Ÿæ·»åŠ è¿›åº¦æ¡åŠ¨ç”»ç±»
                    setTimeout(() => {
                        document.querySelectorAll('.progress-bar-fill').forEach(fill => {
                            fill.classList.add('animate');
                        });
                    }, 300);
                }, 200);
            }, 2000);
        }

        // å…³é—­ç»“æœé¢æ¿
        function closeResultPanel() {
            resultPanel.classList.remove('show');
            
            // ç§»é™¤è¿›åº¦æ¡åŠ¨ç”»ç±»
            document.querySelectorAll('.progress-bar-fill').forEach(fill => {
                fill.classList.remove('animate');
            });
            
            // å»¶è¿Ÿéšè—é¢æ¿
            setTimeout(() => {
                resultPanel.style.display = 'none';
            }, 500);
        }

        // æ˜¾ç¤ºä½¿ç”¨è¯´æ˜
        function showTutorial() {
            tutorialOverlay.classList.add('show');
        }

        // å…³é—­ä½¿ç”¨è¯´æ˜
        function closeTutorial() {
            tutorialOverlay.classList.remove('show');
        }

        // åˆ‡æ¢ç¤ºä¾‹é€‰æ‹©å™¨
        function toggleExampleSelector() {
            exampleSelector.classList.toggle('show');
        }

        // åŠ è½½ç¤ºä¾‹å†…å®¹
        function loadExample(type) {
            correctVersion.textContent = exampleContents[type].correct;
            reciteVersion.textContent = '';
            exampleSelector.classList.remove('show');
        }

        // ä¸Šä¼ ç…§ç‰‡ï¼ˆæ¨¡æ‹Ÿï¼‰
        function uploadPhoto(source, target) {
            const targetElement = target === 'correct' ? correctVersion : reciteVersion;
            
            // æ¨¡æ‹Ÿä¸Šä¼ å’Œè¯†åˆ«è¿‡ç¨‹
            targetElement.textContent = 'æ­£åœ¨å¤„ç†å›¾ç‰‡...';
            
            setTimeout(() => {
                if (target === 'correct') {
                    // éšæœºé€‰æ‹©ä¸€ä¸ªç¤ºä¾‹å†…å®¹
                    const examples = ['philosophy', 'politics', 'history', 'english', 'math'];
                    const randomExample = examples[Math.floor(Math.random() * examples.length)];
                    targetElement.textContent = exampleContents[randomExample].correct;
                } else {
                    // å¦‚æœæ­£ç¡®ç‰ˆæœ¬å·²æœ‰å†…å®¹ï¼Œå°è¯•åŒ¹é…å¯¹åº”çš„èƒŒè¯µç‰ˆæœ¬
                    const correct = correctVersion.textContent;
                    if (correct.includes('é©¬å…‹æ€ä¸»ä¹‰è®¤è¯†è®º')) {
                        targetElement.textContent = exampleContents.philosophy.recite;
                    } else if (correct.includes('å•†å“æ˜¯ç”¨æ¥äº¤æ¢çš„åŠ³åŠ¨äº§å“')) {
                        targetElement.textContent = exampleContents.politics.recite;
                    } else if (correct.includes('æ–°æ°‘ä¸»ä¸»ä¹‰é©å‘½')) {
                        targetElement.textContent = exampleContents.history.recite;
                    } else if (correct.includes('Academic writing')) {
                        targetElement.textContent = exampleContents.english.recite;
                    } else if (correct.includes('æé™çš„Îµ-Î´å®šä¹‰')) {
                        targetElement.textContent = exampleContents.math.recite;
                    } else {
                        targetElement.textContent = 'å›¾ç‰‡è¯†åˆ«å®Œæˆã€‚è¯·æ£€æŸ¥è¯†åˆ«ç»“æœæ˜¯å¦å‡†ç¡®ã€‚';
                    }
                }
            }, 1500);
        }

        // æ£€æŸ¥æ˜¯å¦æ˜¯é¦–æ¬¡è®¿é—®ï¼Œå¦‚æœæ˜¯åˆ™æ˜¾ç¤ºæ•™ç¨‹
        if (!localStorage.getItem('tutorialShown')) {
            setTimeout(() => {
                showTutorial();
                localStorage.setItem('tutorialShown', 'true');
            }, 1000);
        }

        // é¡µé¢åŠ è½½æ—¶æ›´æ–°ç¤ºä¾‹é€‰æ‹©å™¨
        document.addEventListener('DOMContentLoaded', function() {
            updateExampleSelector();
        });

        // åœ¨ç¤ºä¾‹é€‰æ‹©å™¨ä¸­æ·»åŠ æ–°çš„ç¤ºä¾‹é€‰é¡¹
        function updateExampleSelector() {
            const exampleSelector = document.getElementById('exampleSelector');
            exampleSelector.innerHTML = `
                    <div class="example-item" onclick="loadExample('philosophy')">
                        <div class="example-item-title">é©¬å…‹æ€ä¸»ä¹‰å“²å­¦</div>
                        <div class="example-item-desc">è®¤è¯†è®ºåŸºæœ¬åŸç†</div>
                    </div>
                    <div class="example-item" onclick="loadExample('politics')">
                        <div class="example-item-title">æ”¿æ²»ç»æµå­¦</div>
                        <div class="example-item-desc">å•†å“çš„äºŒå› ç´ </div>
                    </div>
                    <div class="example-item" onclick="loadExample('history')">
                        <div class="example-item-title">ä¸­å›½è¿‘ä»£å²</div>
                        <div class="example-item-desc">æ–°æ°‘ä¸»ä¸»ä¹‰é©å‘½</div>
                    </div>
                <div class="example-item" onclick="loadExample('english')">
                    <div class="example-item-title">è€ƒç ”è‹±è¯­</div>
                    <div class="example-item-desc">å­¦æœ¯å†™ä½œç‰¹ç‚¹</div>
                </div>
                <div class="example-item" onclick="loadExample('math')">
                    <div class="example-item-title">é«˜ç­‰æ•°å­¦</div>
                    <div class="example-item-desc">æé™ä¸è¿ç»­æ€§</div>
            </div>
            `;
        }
    </script>
</body>
</html>